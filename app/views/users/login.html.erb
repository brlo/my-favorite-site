
<div style='text-align: center;'>
  <script async src="https://telegram.org/js/telegram-widget.js?19" data-telegram-login="bibleox_bot" data-size="large" data-onauth="onTelegramAuth(user)"></script>
  <script type="text/javascript">
    function onTelegramAuth(user) {
      //alert('Logged in as ' + user.first_name + ' ' + user.last_name + ' (' + user.id + (user.username ? ', @' + user.username : '') + ')');
      const params = {
        id: user.id, first_name: user.first_name, last_name: user.last_name, username: user.username, photo_url: user.photo_url, auth_date: user.auth_date, hash: user.hash
      };
      axios.post('/ru/login_telegram/', params)
      .then(function (response) {
        const data = response.data;
        if (data.status == 'ok') {
          window.location.href = data.url;
        } else {
          console.log(data);
        };
      }).catch(function (error) {
        console.log('error', error);
      });
    }
  </script>

  <% if @is_site_auth_enabled %>
    <%= form_tag handle_login_site_path(locale: ::I18n.locale) do %>
      <div class='hint'>
        <label for='username'>Username</label>
      </div>
      <div>
        <input class='pretty' type='text' name='username' id='username' autocomplete='username' required>
      </div>
      <div>
      <div class='hint'>
        <label for='password'>Password</label>
      </div>
        <input class='pretty' type='password' name='password' id='password' autocomplete='password' required>
      </div>
      <div>
        <br>
        <input class='pretty btn' type='submit' name='commit' value='Login' data-disable-with='Login'>
      </div>
    <% end %>
  <% end %>

</div>
